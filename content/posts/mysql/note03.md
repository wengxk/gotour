---
title: "InnoDB On-Disk Structures"
date: 2019-09-08
type:
- post
- posts
categories:
- mysql
---

# InnoDB 磁盘结构

InnoDB磁盘结构和Oracle数据库的磁盘结构具有一定相似性，比方说，都以一定的逻辑结构维护组织具体磁盘文件，
都有Tablespace（表空间）、Segment（段）、Extent（区）和Page（页）的逻辑概念，
其中，Page在Oracle数据库中多以Block（数据块）表示。

## 磁盘逻辑结构

### Tablespace

表空间是逻辑结构的最顶层，所以InnoDB中的所有数据必定是逻辑的归属于一个表空间，表空间又由Segment（段）、Extent（区）和Page（页）逻辑组成。

系统表空间ibdata1主要是用来组织存放doublewrite buffer和change buffer，还会用来共享存放一些数据，例如回滚信息、系统事物信息。

目前InnoDB存储引擎和数据库使用方都会默认开启 `innodb_file_per_table` 参数，即为每张用户表单独创建一个表空间及物理文件，
所以你经常会发现，索引的名称默认就是索引列的名称，不同用户表的相同列的索引就会有相同的索引名称，而这在Oracle数据库中几乎是不会存在的。
在使用Oracle数据库时，在创建实例后的第一件事就是创建业务表空间，然后再创建主要的数据库用户并为之分配默认表空间，
而后以这个用户创建的对象默认表空间都是这个用户所在的表空间，所以不能存在相同名称的同一类对象。

### Segment

段是InnoDB的次级逻辑结构，常见有数据段、索引段和回滚段，对于段，我们几乎不需要手工维护任何东西，有个概念即可。

### Extent

区是最小的扩展单位，是由连续页组成的空间，在任何情况下每个区的大小都为1MB。为了保证区中页的连续性，InnoDB存储引擎一次从磁盘申请4～5个区。
在默认情况下，InnoDB存储引擎页的大小为16KB，即一个区中一共有64个连续的页。

### Page

页是最小的存储单位，默认16K，由参数 `innodb_page_size` 控制，
同时，页也是最小的读取单位，InnoDB引擎在进行磁盘读取数据时都是整页的读取，然后将整页数据缓冲到buffer pool中。

## 表



## 索引
